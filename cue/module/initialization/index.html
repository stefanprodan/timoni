
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Timoni is a package manager for Kubernetes powered by CUE lang.
">
      
      
        <meta name="author" content="Stefan Prodan">
      
      
        <link rel="canonical" href="https://timoni.sh/cue/module/initialization/">
      
      
        <link rel="prev" href="../../walkthrough/">
      
      
        <link rel="next" href="../immutable-config/">
      
      
      <link rel="icon" href="../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Get started with modules - Timoni</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    

<meta property="og:url" content="https://timoni.sh/cue/module/initialization/">
<meta property="og:image" content="https://timoni.sh/images/logo_card.png">
<meta property="og:image:alt" content="timoni.sh">
<meta property="og:image:type" content="image/png">

<meta property="og:title" content="Get started with modules">
<meta property="og:description" content="Timoni is a package manager for Kubernetes powered by CUE lang.
">


<meta name="twitter:site" content="@stefanprodan">
<meta name="twitter:creator" content="@stefanprodan">
<meta name="twitter:image:alt" content="timoni.sh">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://timoni.sh/images/logo.png">
<meta property="twitter:title" content="Get started with modules">
<meta property="twitter:description" content="Timoni is a package manager for Kubernetes powered by CUE lang.
">



  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#get-started-with-timoni-modules" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Timoni" class="md-header__button md-logo" aria-label="Timoni" data-md-component="logo">
      
  <img src="../../../images/logo_indigo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Timoni
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Get started with modules
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/stefanprodan/timoni" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    stefanprodan/timoni
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../quickstart/" class="md-tabs__link">
          
  
  Documentation

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../introduction/" class="md-tabs__link">
          
  
  CUE Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../cmd/timoni/" class="md-tabs__link">
          
  
  CLI Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Timoni" class="md-nav__button md-logo" aria-label="Timoni" data-md-component="logo">
      
  <img src="../../../images/logo_indigo.svg" alt="logo">

    </a>
    Timoni
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stefanprodan/timoni" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    stefanprodan/timoni
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quickstart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../concepts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concepts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../comparison/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compared to other tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    App Delivery
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            App Delivery
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../bundle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bundle files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../bundle-runtime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bundle runtime
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../bundle-distribution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bundle distribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../bundle-secrets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bundle secrets injection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../bundle-multi-cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multi-cluster deployments
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    App Packaging
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            App Packaging
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Module specification
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
        
          
          <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Integrations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_7">
            <span class="md-nav__icon md-icon"></span>
            Integrations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../github-actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub Actions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../flux-aio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flux AIO Distribution
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../flux-helm-interop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Helm Interoperability
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../gitops-flux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitOps with Flux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    CUE Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            CUE Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../walkthrough/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CUE Walkthrough
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Module Development
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Module Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Get started with modules
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Get started with modules
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#initialize-a-module" class="md-nav__link">
    <span class="md-ellipsis">
      Initialize a module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Module structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Development commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Development commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-and-apply-the-module" class="md-nav__link">
    <span class="md-ellipsis">
      Build and apply the module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-with-custom-values" class="md-nav__link">
    <span class="md-ellipsis">
      Build with custom values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vetting-the-module" class="md-nav__link">
    <span class="md-ellipsis">
      Vetting the module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format-the-module-files" class="md-nav__link">
    <span class="md-ellipsis">
      Format the module files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-the-kubernetes-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      Update the Kubernetes schemas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-the-timoni-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      Update the Timoni schemas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#templates-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Templates overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Templates overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#config-definition" class="md-nav__link">
    <span class="md-ellipsis">
      Config definition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-definition" class="md-nav__link">
    <span class="md-ellipsis">
      Instance definition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes definitions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extend-the-module-config" class="md-nav__link">
    <span class="md-ellipsis">
      Extend the module config
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extend the module config">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-the-config-field" class="md-nav__link">
    <span class="md-ellipsis">
      Add the config field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map-the-field-in-the-template" class="md-nav__link">
    <span class="md-ellipsis">
      Map the field in the template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-config" class="md-nav__link">
    <span class="md-ellipsis">
      Test the config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../immutable-config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Immutable ConfigMaps and Secrets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom-resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add custom resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../semver-constraints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster version constraints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../apply-behavior/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Control the apply behavior
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../test-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run tests with Kubernetes Jobs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../import-resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Import resources from YAML
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Module Distribution
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Module Distribution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../publishing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publishing module versions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../signing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Signing and Verification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../github-actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub Actions
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CLI Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            CLI Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_version/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni version
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Instance
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Instance
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_apply/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni apply
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni build
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni delete
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_inspect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni inspect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_inspect_module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni inspect module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_inspect_values/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni inspect values
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_inspect_resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni inspect resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_status/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni status
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Module
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Module
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_mod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni mod
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_mod_init/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni mod init
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_mod_push/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni mod push
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_mod_pull/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni mod pull
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_mod_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni mod list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_mod_vet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni mod vet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_mod_vendor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni mod vendor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_mod_vendor_k8s/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni mod vendor k8s
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_mod_vendor_crd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni mod vendor crd
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Bundle
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Bundle
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_bundle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni bundle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_bundle_apply/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni bundle apply
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_bundle_build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni bundle build
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_bundle_delete/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni bundle delete
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_bundle_status/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni bundle status
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_bundle_vet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni bundle vet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Runtime
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Runtime
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_runtime/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni runtime
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_runtime_build/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni runtime build
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <label class="md-nav__link" for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Registry
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Registry
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_registry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni registry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_registry_login/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni registry login
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_registry_logout/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni registry logout
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Artifact
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Artifact
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_artifact/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni artifact
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_artifact_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni artifact list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_artifact_push/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni artifact push
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_artifact_pull/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni artifact pull
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_artifact_tag/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni artifact tag
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          <label class="md-nav__link" for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Completion
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            Completion
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_completion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni completion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_completion_bash/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni completion bash
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_completion_fish/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni completion fish
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_completion_powershell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni completion powershell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../cmd/timoni_completion_zsh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timoni completion zsh
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#initialize-a-module" class="md-nav__link">
    <span class="md-ellipsis">
      Initialize a module
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-structure" class="md-nav__link">
    <span class="md-ellipsis">
      Module structure
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development-commands" class="md-nav__link">
    <span class="md-ellipsis">
      Development commands
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Development commands">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-and-apply-the-module" class="md-nav__link">
    <span class="md-ellipsis">
      Build and apply the module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-with-custom-values" class="md-nav__link">
    <span class="md-ellipsis">
      Build with custom values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vetting-the-module" class="md-nav__link">
    <span class="md-ellipsis">
      Vetting the module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#format-the-module-files" class="md-nav__link">
    <span class="md-ellipsis">
      Format the module files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-the-kubernetes-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      Update the Kubernetes schemas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-the-timoni-schemas" class="md-nav__link">
    <span class="md-ellipsis">
      Update the Timoni schemas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#templates-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Templates overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Templates overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#config-definition" class="md-nav__link">
    <span class="md-ellipsis">
      Config definition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-definition" class="md-nav__link">
    <span class="md-ellipsis">
      Instance definition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes definitions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extend-the-module-config" class="md-nav__link">
    <span class="md-ellipsis">
      Extend the module config
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extend the module config">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-the-config-field" class="md-nav__link">
    <span class="md-ellipsis">
      Add the config field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#map-the-field-in-the-template" class="md-nav__link">
    <span class="md-ellipsis">
      Map the field in the template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-config" class="md-nav__link">
    <span class="md-ellipsis">
      Test the config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="get-started-with-timoni-modules">Get Started with Timoni Modules</h1>
<p>This guide will walk you through the process of creating a new Timoni module.
We'll explore the structure of the created module, and the various development
commands that Timoni provides to aid module development.</p>
<p>Furthermore, this guide provides an overview of the templating system,
including the module configuration values, the Kubernetes templates,
and how to generate Kubernetes objects from these templates.</p>
<h2 id="initialize-a-module">Initialize a module</h2>
<p>To create a module in the current directory, run the following command:</p>
<div class="highlight"><pre><span></span><code>timoni<span class="w"> </span>mod<span class="w"> </span>init<span class="w"> </span>myapp<span class="w"> </span><span class="se">\</span>
--blueprint<span class="w"> </span>oci://ghcr.io/stefanprodan/timoni/blueprints/starter
</code></pre></div>
<p>The starter blueprint will create a simple module that deploys a NGINX web server.</p>
<h2 id="module-structure">Module structure</h2>
<p>The init command creates a directory named <code>myapp</code> with the following structure:</p>
<div class="highlight"><pre><span></span><code>myapp
<span class="w"> </span>cue.mod
<span class="w"> </span><span class="w"> </span>gen<span class="w"> </span><span class="c1"># Kubernetes APIs and CRDs schemas</span>
<span class="w"> </span><span class="w"> </span>pkg<span class="w"> </span><span class="c1"># Timoni APIs schemas</span>
<span class="w"> </span><span class="w"> </span>module.cue<span class="w"> </span><span class="c1"># Module metadata</span>
<span class="w"> </span>templates
<span class="w"> </span><span class="w"> </span>config.cue<span class="w"> </span><span class="c1"># Config schema and default values</span>
<span class="w"> </span><span class="w"> </span>deployment.cue<span class="w"> </span><span class="c1"># Kubernetes Deployment template</span>
<span class="w"> </span><span class="w"> </span>service.cue<span class="w"> </span><span class="c1"># Kubernetes Service template</span>
<span class="w"> </span>timoni.cue<span class="w"> </span><span class="c1"># Timoni entry point</span>
<span class="w"> </span>timoni.ignore<span class="w"> </span><span class="c1"># Timoni ignore rules</span>
<span class="w"> </span>values.cue<span class="w"> </span><span class="c1"># Timoni values placeholder </span>
<span class="w"> </span>LICENSE<span class="w"> </span><span class="c1"># Module license</span>
<span class="w"> </span>README.md<span class="w"> </span><span class="c1"># Module documentation</span>
</code></pre></div>
<p>Navigate to the root directory of the new module with <code>cd myapp</code>,
this is where we'll be working from now on.</p>
<h2 id="development-commands">Development commands</h2>
<p>Timoni comes with a set of commands that help with module development.</p>
<p>At most times, after making changes, you'll be using the
<a href="#vetting-the-module"><code>timoni mod vet</code></a> command to verify that
the module config and the Kubernetes templates are valid.</p>
<h3 id="build-and-apply-the-module">Build and apply the module</h3>
<p>To build a module instance, run the following command:</p>
<div class="highlight"><pre><span></span><code>timoni<span class="w"> </span>-n<span class="w"> </span><span class="nb">test</span><span class="w"> </span>build<span class="w"> </span>nginx<span class="w"> </span>.
</code></pre></div>
<p>The build command generates a Kubernetes Deployment and Service,
and prints the Kubernetes resources to stdout in YAML format.</p>
<p>If you inspect the output, you'll notice that the Kubernetes <code>metadata</code>
matches the instance name and namespace specified in the build command:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app.kubernetes.io/managed-by</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">timoni</span>
<span class="w">    </span><span class="nt">app.kubernetes.io/name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">    </span><span class="nt">app.kubernetes.io/version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0-devel</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test</span>
</code></pre></div>
<p>By convention, Timoni uses the <code>app.kubernetes.io/name</code> label to set the
Deployment selector and the Service selector.</p>
<p>The <code>app.kubernetes.io/version</code> label is used to track the module version
from the container registry, and it's set to <code>0.0.0-devel</code> by default, when
building a module locally.</p>
<p>To create the module instance on a Kubernetes cluster:</p>
<div class="highlight"><pre><span></span><code>timoni<span class="w"> </span>-n<span class="w"> </span><span class="nb">test</span><span class="w"> </span>apply<span class="w"> </span>nginx<span class="w"> </span>.
</code></pre></div>
<p>The apply command will create the Kubernetes resources and will wait for the
Deployment and Service to become ready. If the <code>test</code> namespace doesn't exist,
Timoni will create it.</p>
<div class="admonition tip">
<p class="admonition-title">Diff changes</p>
<p>When making changes to the module, you can use the <code>timoni apply --diff</code>
flag to see the differences between the in-cluster resources
and the newly generated ones.</p>
</div>
<p>To delete the module instance:</p>
<div class="highlight"><pre><span></span><code>timoni<span class="w"> </span>-n<span class="w"> </span><span class="nb">test</span><span class="w"> </span>delete<span class="w"> </span>nginx<span class="w"> </span>.
</code></pre></div>
<p>The delete command will remove the Kubernetes Deployment and Service from the cluster,
but will leave the <code>test</code> namespace intact, because the namespace resource
is not part of the module.</p>
<h3 id="build-with-custom-values">Build with custom values</h3>
<p>For debugging purposes, the blueprint contains a <code>debug_values.cue</code> file
that can be used to test the module with custom values.</p>
<p>To build a module instance with the debug values, run the following command:</p>
<div class="highlight"><pre><span></span><code>timoni<span class="w"> </span>-n<span class="w"> </span><span class="nb">test</span><span class="w"> </span>build<span class="w"> </span>nginx<span class="w"> </span>.<span class="w"> </span>--values<span class="w"> </span>debug_values.cue
</code></pre></div>
<p>If you inspect the output, you'll notice that the Deployment container image
has changed from <code>docker.io/nginx:1-alpine</code> to <code>docker.io/nginx:1-alpine-slim</code>,
as specified in the <code>debug_values.cue</code> file.</p>
<div class="admonition tip">
<p class="admonition-title">Ignore rules</p>
<p>Note that the <code>debug_values.cue</code> file is listed in <code>timoni.ignore</code>,
and will be excluded when publishing the module to a container registry.
The debug values are meant to be used only for local testing while developing
the module.</p>
</div>
<h3 id="vetting-the-module">Vetting the module</h3>
<p>The vet command is your best friend when developing modules.
It verifies that the module structure is compliant with the Timoni specification,
then it builds the module and validates the generated Kubernetes
resources against their CUE schemas.</p>
<p>To vet the module with default values, run the following command:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">command</label><label for="__tabbed_1_2">output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>timoni<span class="w"> </span>mod<span class="w"> </span>vet<span class="w"> </span>--name<span class="w"> </span>nginx
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>INF vetting with default values
INF Deployment/default/nginx valid resource
INF Service/default/nginx valid resource
INF docker.io/nginx:1-alpine valid image (digest missing)
INF timoni.sh/myapp valid module
</code></pre></div>
</div>
</div>
</div>
<p>The vet command will print the list of Kubernetes resources and their validation status,
along with the container images referenced in the module.</p>
<p>It is also possible to verify the module using the debug values:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">command</label><label for="__tabbed_2_2">output</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>timoni<span class="w"> </span>mod<span class="w"> </span>vet<span class="w"> </span>--debug<span class="w"> </span>--name<span class="w"> </span>nginx<span class="w"> </span>--namespace<span class="w"> </span><span class="nb">test</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>INF vetting with debug values
INF Deployment/test/nginx valid resource
INF Service/test/nginx valid resource
INF docker.io/nginx:1-alpine-slim valid image (digest missing)
INF timoni.sh/myapp valid module
</code></pre></div>
</div>
</div>
</div>
<p>If the vet command encounters an invalid definition, it will print the error message,
the file and line number where the error occurred.</p>
<h3 id="format-the-module-files">Format the module files</h3>
<p>Similar to Go, CUE has a built-in code formatter that can be used to format CUE files.</p>
<p>To format all files in a module, run the following command:</p>
<div class="highlight"><pre><span></span><code>cue<span class="w"> </span>fmt<span class="w"> </span>./...
</code></pre></div>
<p>It is recommended to run this command after making changes to a module. Most editors
have a CUE plugin that can run the <code>cue fmt</code> command automatically when saving a file.</p>
<h3 id="update-the-kubernetes-schemas">Update the Kubernetes schemas</h3>
<p>To ensure that the Kubernetes resources defined in a module
are in conformance with their OpenAPI schema, Timoni offers a command for
vendoring CUE definitions generated from the Kubernetes builtin APIs.</p>
<p>To update the schemas to the latest Kubernetes stable release, run the following command:</p>
<div class="highlight"><pre><span></span><code>timoni<span class="w"> </span>mod<span class="w"> </span>vendor<span class="w"> </span>k8s
</code></pre></div>
<p>The vendor command will download the Kubernetes schemas from GitHub
<a href="https://github.com/stefanprodan/kubernetes-cue-schema/pkgs/container/timoni%2Fkubernetes-schema">container registry</a>,
and will update the CUE definitions from the <code>cue.mod/gen/k8s.io</code> directory.</p>
<h3 id="update-the-timoni-schemas">Update the Timoni schemas</h3>
<p>Timoni comes with a set of CUE definitions (schemas and generators), that are used to reduce the
boilerplate code when developing modules. These definitions are included in the modules generated
with <code>timoni mod init</code>, and are vendored in the <code>cue.mod/pkg/timoni</code> directory.</p>
<p>To update the Timoni schemas to the latest version,
run the following command from within the module root:</p>
<div class="highlight"><pre><span></span><code>timoni<span class="w"> </span>artifact<span class="w"> </span>pull<span class="w"> </span>oci://ghcr.io/stefanprodan/timoni/schemas<span class="w"> </span>-o<span class="w"> </span>cue.mod/pkg
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Schemas versioning</p>
<p>The schemas are published with every Timoni release, each Timoni version has
a corresponding schemas artifact tag. While the Timoni API is in alpha,
the schemas may change between releases in a non-backwards compatible way.</p>
</div>
<h2 id="templates-overview">Templates overview</h2>
<p>The templates directory contains the module configuration schema
and the Kubernetes resources templates.</p>
<h3 id="config-definition">Config definition</h3>
<p>The <code>config.cue</code> file contains a <a href="../../walkthrough/#schema-definitions">schema definition</a>
called <code>#Config</code> that is used to specify which input fields can be configured by end-users
when applying a module instance.</p>
<p>For each input field, the <code>#Config</code> definition can specify the field type, if it is
required or optional, if it has a <a href="../../walkthrough/#default-values">default value</a>,
and which <a href="../../walkthrough/#field-constraints">validation rules</a> should be applied.</p>
<p>For example, the <code>#Config</code> contains a <code>replicas</code> field defined like this:</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="nx">Config</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">replicas</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">&gt;</span><span class="mi">0</span>
<span class="p">}</span>
</code></pre></div>
<p>This means that the <code>replicas</code> field defaults to the value of <code>1</code>, and when specified,
the user-supplied value must be an integer greater than zero.</p>
<p>The <code>replicas</code> value is used in the <code>deployment.cue</code> template to set the
<code>spec.replicas</code> field of the Kubernetes Deployment:</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="nx">Deployment</span><span class="p">:</span><span class="w"> </span><span class="nx">appsv1</span><span class="p">.</span><span class="err">#</span><span class="nx">Deployment</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">#</span><span class="nx">config</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="nx">Config</span>
<span class="w">    </span><span class="nx">spec</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">replicas</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="nx">config</span><span class="p">.</span><span class="nx">replicas</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="instance-definition">Instance definition</h3>
<p>The <code>config.cue</code> file contains a definition called <code>#Instance</code> that is used to specify
the list of Kubernetes objects that will be generated from templates when
building and applying a module instance.</p>
<p>For example, the <code>#Instance</code> definition takes as input a <code>#Config</code> object
and returns the list of objects with the <code>#Deployment</code> and <code>#Service</code> types:</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="nx">Instance</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">config</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="nx">Config</span>

<span class="w">    </span><span class="nx">objects</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">deploy</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="nx">Deployment</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="err">#</span><span class="nx">config</span><span class="p">:</span><span class="w"> </span><span class="nx">config</span><span class="p">}</span>
<span class="w">        </span><span class="nx">service</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="nx">Service</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span><span class="err">#</span><span class="nx">config</span><span class="p">:</span><span class="w"> </span><span class="nx">config</span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The <code>#Instance</code> definition is used in by the Timoni entry point,
defined in <code>timoni.cue</code> file from the root directory,
which injects the instance name, namespace and user-supplied config
values and then applies the generated objects on the cluster.</p>
<div class="highlight"><pre><span></span><code><span class="nx">timoni</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">instance</span><span class="p">:</span><span class="w"> </span><span class="nx">templates</span><span class="p">.</span><span class="err">#</span><span class="nx">Instance</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">config</span><span class="p">:</span><span class="w"> </span><span class="nx">values</span>
<span class="w">        </span><span class="nx">config</span><span class="p">:</span><span class="w"> </span><span class="nx">metadata</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">name</span><span class="p">:</span><span class="w">      </span><span class="kt">string</span><span class="w"> </span><span class="err">@</span><span class="nx">tag</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span>
<span class="w">            </span><span class="nx">namespace</span><span class="p">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="err">@</span><span class="nx">tag</span><span class="p">(</span><span class="nx">namespace</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">apply</span><span class="p">:</span><span class="w"> </span><span class="nx">app</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="k">for</span><span class="w"> </span><span class="nx">obj</span><span class="w"> </span><span class="nx">in</span><span class="w"> </span><span class="nx">instance</span><span class="p">.</span><span class="nx">objects</span><span class="w"> </span><span class="p">{</span><span class="nx">obj</span><span class="p">}]</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="kubernetes-definitions">Kubernetes definitions</h3>
<p>The <code>deployment.cue</code> and <code>service.cue</code> files contain the
<a href="../../walkthrough/#schema-definitions">CUE definitions</a>
used to generate the Deployment and Service Kubernetes objects.</p>
<p>Let's take a look at the <code>service.cue</code> file:</p>
<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nx">templates</span>

<span class="kn">import</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="nx">corev1</span><span class="w"> </span><span class="s">&quot;k8s.io/api/core/v1&quot;</span>
<span class="p">)</span>

<span class="err">#</span><span class="nx">Service</span><span class="p">:</span><span class="w"> </span><span class="nx">corev1</span><span class="p">.</span><span class="err">#</span><span class="nx">Service</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">#</span><span class="nx">config</span><span class="p">:</span><span class="w">    </span><span class="err">#</span><span class="nx">Config</span>
<span class="w">    </span><span class="nx">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;v1&quot;</span>
<span class="w">    </span><span class="nx">kind</span><span class="p">:</span><span class="w">       </span><span class="s">&quot;Service&quot;</span>
<span class="w">    </span><span class="nx">metadata</span><span class="p">:</span><span class="w">   </span><span class="err">#</span><span class="nx">config</span><span class="p">.</span><span class="nx">metadata</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="err">#</span><span class="nx">config</span><span class="p">.</span><span class="nx">service</span><span class="p">.</span><span class="nx">annotations</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">_</span><span class="o">|</span><span class="nx">_</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">metadata</span><span class="p">:</span><span class="w"> </span><span class="nx">annotations</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="nx">config</span><span class="p">.</span><span class="nx">service</span><span class="p">.</span><span class="nx">annotations</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">spec</span><span class="p">:</span><span class="w"> </span><span class="nx">corev1</span><span class="p">.</span><span class="err">#</span><span class="nx">ServiceSpec</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">selector</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="nx">config</span><span class="p">.</span><span class="nx">selector</span><span class="p">.</span><span class="nx">labels</span>
<span class="w">        </span><span class="nx">ports</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="nx">port</span><span class="p">:</span><span class="w">       </span><span class="err">#</span><span class="nx">config</span><span class="p">.</span><span class="nx">service</span><span class="p">.</span><span class="nx">port</span>
<span class="w">                </span><span class="nx">protocol</span><span class="p">:</span><span class="w">   </span><span class="s">&quot;TCP&quot;</span>
<span class="w">                </span><span class="nx">name</span><span class="p">:</span><span class="w">       </span><span class="s">&quot;http&quot;</span>
<span class="w">                </span><span class="nx">targetPort</span><span class="p">:</span><span class="w"> </span><span class="nx">name</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>The <code>package</code> directive specifies the CUE package name,
the package name should match the directory name.</p>
<p>The <code>import</code> directive is used to import packages from the <code>cue.mod</code> directory,
in this case the <code>k8s.io/api/core/v1</code> package is imported as <code>corev1</code>. We need this
package to generate any Kubernetes object that is part of the <code>v1</code> API group, like
ConfigMap, Secret, ServiceAccount, Service, etc.</p>
<p>With <code>#Service: corev1.#Service &amp; {...}</code> we specify that our <code>#Service</code> definition
is a Kubernetes Service object, and that it should inherit all the fields from the
<code>corev1.#Service</code> type. This ensures that the generated object will be validated
against the Kubernetes API schema.</p>
<p>Inside the <code>#Service</code> definition, we have a <code>#config</code> field of type <code>#Config</code>.
The <code>#config</code> field is used as an input parameter for the user-supplied values.</p>
<p>The rest of the <code>#Service</code> definition is used to set the Kubernetes object fields
to the <code>#config</code> values.</p>
<p>Optional config fields, like the <code>service.annotations</code>, should be set only if the user
supplied a value for them. To verify if a field has a value, we can use an if statement
and map the config field inside:</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="err">#</span><span class="nx">config</span><span class="p">.</span><span class="nx">service</span><span class="p">.</span><span class="nx">annotations</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nx">_</span><span class="o">|</span><span class="nx">_</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">metadata</span><span class="p">:</span><span class="w"> </span><span class="nx">annotations</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="nx">config</span><span class="p">.</span><span class="nx">service</span><span class="p">.</span><span class="nx">annotations</span>
<span class="p">}</span>
</code></pre></div>
<p>Besides mapping the config fields to the Kubernetes object fields, we can also
set fixed values, like the port <code>protocol</code> and <code>name</code> fields.</p>
<h2 id="extend-the-module-config">Extend the module config</h2>
<p>Assuming that you want to allow users to expose the NGINX service outside the cluster
as a NodePort or LoadBalancer type. To do this, you can add a field called <code>type</code>
to the <code>service</code> section of the <code>#Config</code> definition, then map the <code>type</code> value to the
Kubernetes Service <code>spec.type</code> field.</p>
<h3 id="add-the-config-field">Add the config field</h3>
<p>Open the <code>config.cue</code> file and add the <code>type</code> field to the <code>service</code> section:</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="nx">Config</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">service</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">type</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="s">&quot;ClusterIP&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">&quot;NodePort&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s">&quot;LoadBalancer&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>With the <code>*</code> operator we specify that the <code>type</code> field has a default value of <code>ClusterIP</code>.</p>
<p>With the <code>|</code> operator we enumerate the allowed values for the <code>type</code> field.</p>
<div class="admonition tip">
<p class="admonition-title">Documentation</p>
<p>Note that you should document newly added fields in the module's <code>README.md</code> file.
The readme contains a table with the module configuration fields, their type,
default value and description.</p>
</div>
<h3 id="map-the-field-in-the-template">Map the field in the template</h3>
<p>Open the <code>service.cue</code> file and set the <code>spec.type</code> field to the <code>#config.service.type</code> value:</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="nx">Service</span><span class="p">:</span><span class="w"> </span><span class="nx">corev1</span><span class="p">.</span><span class="err">#</span><span class="nx">Service</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">#</span><span class="nx">config</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="nx">Config</span>

<span class="w">    </span><span class="nx">spec</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">type</span><span class="p">:</span><span class="w"> </span><span class="err">#</span><span class="nx">config</span><span class="p">.</span><span class="nx">service</span><span class="p">.</span><span class="kd">type</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="test-the-config">Test the config</h3>
<p>To test the new config field, we can build the module with the default values,
and check the generated Service:</p>
<div class="highlight"><pre><span></span><code>timoni<span class="w"> </span>build<span class="w"> </span>nginx<span class="w"> </span>.<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>ClusterIP
</code></pre></div>
<p>To test if we can change the Service type,
we can use the <code>debug_values.cue</code> file:</p>
<div class="highlight"><pre><span></span><code><span class="nx">values</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">service</span><span class="p">:</span><span class="w"> </span><span class="kd">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NodePort&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p>And build the module with the debug values:</p>
<div class="highlight"><pre><span></span><code>timoni<span class="w"> </span>build<span class="w"> </span>nginx<span class="w"> </span>.<span class="w"> </span>-f<span class="w"> </span>debug_values.cue<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>NodePort
</code></pre></div>
<p>Finally, we can test the validation rules by setting an
invalid value, e.g. <code>service: type: "foo"</code>.</p>
<p>Running the build or vet command with the debug values
should print a validation error:</p>
<div class="highlight"><pre><span></span><code>timoni<span class="w"> </span>mod<span class="w"> </span>vet<span class="w"> </span>--debug
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright  2024 Stefan Prodan
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://cloud-native.slack.com/team/ULPRMFH38" target="_blank" rel="noopener" title="cloud-native.slack.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/stefanprodan" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h320c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64H64zm297.1 84L257.3 234.6 379.4 396h-95.6L209 298.1 123.3 396H75.8l111-126.9L69.7 116h98l67.7 89.5 78.2-89.5h47.5zm-37.8 251.6L153.4 142.9h-28.3l171.8 224.7h26.3z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/stefanprodan" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "navigation.sections", "navigation.top", "navigation.tabs"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>